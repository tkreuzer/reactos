
HEADER("CR0 flags"),
CONSTANT(CR0_PE),
CONSTANT(CR0_MP),
CONSTANT(CR0_EM),
CONSTANT(CR0_TS),
CONSTANT(CR0_ET),
CONSTANT(CR0_NE),
CONSTANT(CR0_WP),
CONSTANT(CR0_AM),
CONSTANT(CR0_NW),
CONSTANT(CR0_CD),
CONSTANT(CR0_PG),

HEADER("CR4 flags"),
CONSTANT(CR4_VME),
CONSTANT(CR4_PVI),
CONSTANT(CR4_TSD),
CONSTANT(CR4_DE),
CONSTANT(CR4_PSE),
CONSTANT(CR4_PAE),
CONSTANT(CR4_MCE),
CONSTANT(CR4_PGE),
CONSTANT(CR4_FXSR),
CONSTANT(CR4_XMMEXCPT),
CONSTANT(CR4_CHANNELS),

HEADER("KeFeatureBits flags"),
//CONSTANT(KF_RDTSC),
//CONSTANT(KF_CR4),
//CONSTANT(KF_GLOBAL_PAGE),
//CONSTANT(KF_LARGE_PAGE),
//CONSTANT(KF_CMPXCHG8B),
//CONSTANT(KF_FAST_SYSCALL),

HEADER("Machine type definitions"),
CONSTANT(MACHINE_TYPE_ISA),
CONSTANT(MACHINE_TYPE_EISA),
CONSTANT(MACHINE_TYPE_MCA),

HEADER("EFLAGS"),
CONSTANT(EFLAGS_TF_MASK),
CONSTANT(EFLAGS_TF_SHIFT),
CONSTANT(EFLAGS_IF_MASK),
CONSTANT(EFLAGS_IF_SHIFT),
CONSTANT(EFLAGS_ID_MASK),

HEADER("KDGT selectors"),
CONSTANT(KGDT64_NULL),
CONSTANT(KGDT64_R0_CODE),
CONSTANT(KGDT64_R0_DATA),
CONSTANT(KGDT64_R3_CMCODE),
CONSTANT(KGDT64_R3_DATA),
CONSTANT(KGDT64_R3_CODE),
CONSTANT(KGDT64_SYS_TSS),
CONSTANT(KGDT64_R3_CMTEB),

HEADER("Machine Specific Register Numbers"),
CONSTANT(MSR_EFER),
CONSTANT(MSR_STAR),
CONSTANT(MSR_LSTAR),
CONSTANT(MSR_CSTAR),
CONSTANT(MSR_SYSCALL_MASK),
CONSTANT(MSR_FS_BASE),
CONSTANT(MSR_GS_BASE),
CONSTANT(MSR_GS_SWAP),
CONSTANT(MSR_MCG_STATUS),
CONSTANT(MSR_AMD_ACCESS),

HEADER("Flags for MSR_EFER"),
CONSTANT(MSR_LMA),
CONSTANT(MSR_LME),
CONSTANT(MSR_SCE),
CONSTANT(MSR_NXE),
CONSTANT(MSR_PAT),
CONSTANT(MSR_DEGUG_CTL),
CONSTANT(MSR_LAST_BRANCH_FROM),
CONSTANT(MSR_LAST_BRANCH_TO),
CONSTANT(MSR_LAST_EXCEPTION_FROM),
CONSTANT(MSR_LAST_EXCEPTION_TO),

HEADER("Flags for MSR_DEGUG_CTL"),
//CONSTANT(MSR_DEBUG_CTL_LBR),
//CONSTANT(MSR_DEBUG_CRL_BTF),

HEADER("Fatal exception codes"),
CONSTANT(EXCEPTION_DIVIDED_BY_ZERO),
CONSTANT(EXCEPTION_DEBUG),
CONSTANT(EXCEPTION_NMI),
CONSTANT(EXCEPTION_INT3),
CONSTANT(EXCEPTION_BOUND_CHECK),
CONSTANT(EXCEPTION_INVALID_OPCODE),
CONSTANT(EXCEPTION_NPX_NOT_AVAILABLE),
CONSTANT(EXCEPTION_DOUBLE_FAULT),
CONSTANT(EXCEPTION_NPX_OVERRUN),
CONSTANT(EXCEPTION_INVALID_TSS),
CONSTANT(EXCEPTION_SEGMENT_NOT_PRESENT),
CONSTANT(EXCEPTION_STACK_FAULT),
CONSTANT(EXCEPTION_GP_FAULT),
CONSTANT(EXCEPTION_RESERVED_TRAP),
CONSTANT(EXCEPTION_NPX_ERROR),
CONSTANT(EXCEPTION_ALIGNMENT_CHECK),

HEADER("CONTEXT"),
BEGIN_STRUCT(CONTEXT),
    MEMBER(CONTEXT, P1Home, QWORD),
    MEMBER(CONTEXT, P2Home, QWORD),
    MEMBER(CONTEXT, P3Home, QWORD),
    MEMBER(CONTEXT, P4Home, QWORD),
    MEMBER(CONTEXT, P5Home, QWORD),
    MEMBER(CONTEXT, P6Home, QWORD),
    MEMBER(CONTEXT, ContextFlags, DWORD),
    MEMBER(CONTEXT, MxCsr, DWORD),
    MEMBER(CONTEXT, SegCs, WORD),
    MEMBER(CONTEXT, SegDs, WORD),
    MEMBER(CONTEXT, SegEs, WORD),
    MEMBER(CONTEXT, SegFs, WORD),
    MEMBER(CONTEXT, SegGs, WORD),
    MEMBER(CONTEXT, SegSs, WORD),
    MEMBER(CONTEXT, EFlags, DWORD),
    MEMBER(CONTEXT, Dr0, QWORD),
    MEMBER(CONTEXT, Dr1, QWORD),
    MEMBER(CONTEXT, Dr2, QWORD),
    MEMBER(CONTEXT, Dr3, QWORD),
    MEMBER(CONTEXT, Dr6, QWORD),
    MEMBER(CONTEXT, Dr7, QWORD),
    MEMBER(CONTEXT, Rax, QWORD),
    MEMBER(CONTEXT, Rcx, QWORD),
    MEMBER(CONTEXT, Rdx, QWORD),
    MEMBER(CONTEXT, Rbx, QWORD),
    MEMBER(CONTEXT, Rsp, QWORD),
    MEMBER(CONTEXT, Rbp, QWORD),
    MEMBER(CONTEXT, Rsi, QWORD),
    MEMBER(CONTEXT, Rdi, QWORD),
    MEMBER(CONTEXT, R8, QWORD),
    MEMBER(CONTEXT, R9, QWORD),
    MEMBER(CONTEXT, R10, QWORD),
    MEMBER(CONTEXT, R11, QWORD),
    MEMBER(CONTEXT, R12, QWORD),
    MEMBER(CONTEXT, R13, QWORD),
    MEMBER(CONTEXT, R14, QWORD),
    MEMBER(CONTEXT, R15, QWORD),
    MEMBER(CONTEXT, Rip, QWORD),
    //MEMBER(CONTEXT, FltSave, XSAVE_FORMAT_SHORT),
    MEMBER(CONTEXT, Xmm0, OWORD),
    MEMBER(CONTEXT, Xmm1, OWORD),
    MEMBER(CONTEXT, Xmm2, OWORD),
    MEMBER(CONTEXT, Xmm3, OWORD),
    MEMBER(CONTEXT, Xmm4, OWORD),
    MEMBER(CONTEXT, Xmm5, OWORD),
    MEMBER(CONTEXT, Xmm6, OWORD),
    MEMBER(CONTEXT, Xmm7, OWORD),
    MEMBER(CONTEXT, Xmm8, OWORD),
    MEMBER(CONTEXT, Xmm9, OWORD),
    MEMBER(CONTEXT, Xmm10, OWORD),
    MEMBER(CONTEXT, Xmm11, OWORD),
    MEMBER(CONTEXT, Xmm12, OWORD),
    MEMBER(CONTEXT, Xmm13, OWORD),
    MEMBER(CONTEXT, Xmm14, OWORD),
    MEMBER(CONTEXT, Xmm15, OWORD),
    MEMBER(CONTEXT, VectorRegister, OWORD),
    MEMBER(CONTEXT, VectorControl, QWORD),
    MEMBER(CONTEXT, DebugControl, QWORD),
    MEMBER(CONTEXT, LastBranchToRip, QWORD),
    MEMBER(CONTEXT, LastBranchFromRip, QWORD),
    MEMBER(CONTEXT, LastExceptionToRip, QWORD),
    MEMBER(CONTEXT, LastExceptionFromRip, QWORD),
END_STRUCT(CONTEXT),
SIZE(sizeof_CONTEXT, CONTEXT),

HEADER("KTRAP_FRAME"),
BEGIN_STRUCT(KTRAP_FRAME),
    MEMBER(KTRAP_FRAME, P1Home, QWORD),
    MEMBER(KTRAP_FRAME, P2Home, QWORD),
    MEMBER(KTRAP_FRAME, P3Home, QWORD),
    MEMBER(KTRAP_FRAME, P4Home, QWORD),
    MEMBER(KTRAP_FRAME, P5, QWORD),
    MEMBER(KTRAP_FRAME, PreviousMode, BYTE),
    MEMBER(KTRAP_FRAME, PreviousIrql, BYTE),
    MEMBER(KTRAP_FRAME, FaultIndicator, BYTE),
    MEMBER(KTRAP_FRAME, ExceptionActive, BYTE),
    MEMBER(KTRAP_FRAME, MxCsr, DWORD),
    MEMBER(KTRAP_FRAME, Rax, QWORD),
    MEMBER(KTRAP_FRAME, Rcx, QWORD),
    MEMBER(KTRAP_FRAME, Rdx, QWORD),
    MEMBER(KTRAP_FRAME, R8, QWORD),
    MEMBER(KTRAP_FRAME, R9, QWORD),
    MEMBER(KTRAP_FRAME, R10, QWORD),
    MEMBER(KTRAP_FRAME, R11, QWORD),
    MEMBER(KTRAP_FRAME, GsBase, QWORD),
    //MEMBER(KTRAP_FRAME, GsSwap, QWORD),
    MEMBER(KTRAP_FRAME, Xmm0, OWORD),
    MEMBER(KTRAP_FRAME, Xmm1, OWORD),
    MEMBER(KTRAP_FRAME, Xmm2, OWORD),
    MEMBER(KTRAP_FRAME, Xmm3, OWORD),
    MEMBER(KTRAP_FRAME, Xmm4, OWORD),
    MEMBER(KTRAP_FRAME, Xmm5, OWORD),
    MEMBER(KTRAP_FRAME, FaultAddress, QWORD),
    MEMBER(KTRAP_FRAME, Dr0, QWORD),
    MEMBER(KTRAP_FRAME, Dr1, QWORD),
    MEMBER(KTRAP_FRAME, Dr2, QWORD),
    MEMBER(KTRAP_FRAME, Dr3, QWORD),
    MEMBER(KTRAP_FRAME, Dr6, QWORD),
    MEMBER(KTRAP_FRAME, Dr7, QWORD),
    MEMBER(KTRAP_FRAME, DebugControl, QWORD),
    MEMBER(KTRAP_FRAME, LastBranchToRip, QWORD),
    MEMBER(KTRAP_FRAME, LastBranchFromRip, QWORD),
    MEMBER(KTRAP_FRAME, LastExceptionToRip, QWORD),
    MEMBER(KTRAP_FRAME, LastExceptionFromRip, QWORD),
    MEMBER(KTRAP_FRAME, SegDs, WORD),
    MEMBER(KTRAP_FRAME, SegEs, WORD),
    MEMBER(KTRAP_FRAME, SegFs, WORD),
    MEMBER(KTRAP_FRAME, SegGs, WORD),
    MEMBER(KTRAP_FRAME, TrapFrame, QWORD),
    MEMBER(KTRAP_FRAME, Rbx, QWORD),
    MEMBER(KTRAP_FRAME, Rdi, QWORD),
    MEMBER(KTRAP_FRAME, Rsi, QWORD),
    MEMBER(KTRAP_FRAME, Rbp, QWORD),
    MEMBER(KTRAP_FRAME, ErrorCode, QWORD),
    MEMBER(KTRAP_FRAME, Rip, QWORD),
    MEMBER(KTRAP_FRAME, SegCs, WORD),
    MEMBER(KTRAP_FRAME, Logging, BYTE),
    MEMBER(KTRAP_FRAME, EFlags, QWORD),
    MEMBER(KTRAP_FRAME, Rsp, QWORD),
    MEMBER(KTRAP_FRAME, SegSs, WORD),
    MEMBER(KTRAP_FRAME, CodePatchCycle, DWORD),
END_STRUCT(KTRAP_FRAME),
SIZE(sizeof_KTRAP_FRAME, KTRAP_FRAME),

HEADER("KEXCEPTION_FRAME"),
BEGIN_STRUCT(KEXCEPTION_FRAME),
    MEMBER(KEXCEPTION_FRAME, P1Home, QWORD),
    MEMBER(KEXCEPTION_FRAME, P2Home, QWORD),
    MEMBER(KEXCEPTION_FRAME, P3Home, QWORD),
    MEMBER(KEXCEPTION_FRAME, P4Home, QWORD),
    MEMBER(KEXCEPTION_FRAME, P5, QWORD),
    MEMBER(KEXCEPTION_FRAME, InitialStack, QWORD),
    MEMBER(KEXCEPTION_FRAME, Xmm6, OWORD),
    MEMBER(KEXCEPTION_FRAME, Xmm7, OWORD),
    MEMBER(KEXCEPTION_FRAME, Xmm8, OWORD),
    MEMBER(KEXCEPTION_FRAME, Xmm9, OWORD),
    MEMBER(KEXCEPTION_FRAME, Xmm10, OWORD),
    MEMBER(KEXCEPTION_FRAME, Xmm11, OWORD),
    MEMBER(KEXCEPTION_FRAME, Xmm12, OWORD),
    MEMBER(KEXCEPTION_FRAME, Xmm13, OWORD),
    MEMBER(KEXCEPTION_FRAME, Xmm14, OWORD),
    MEMBER(KEXCEPTION_FRAME, Xmm15, OWORD),
    MEMBER(KEXCEPTION_FRAME, TrapFrame, QWORD),
    MEMBER(KEXCEPTION_FRAME, CallbackStack, QWORD),
    MEMBER(KEXCEPTION_FRAME, OutputBuffer, QWORD),
    MEMBER(KEXCEPTION_FRAME, OutputLength, QWORD),
    MEMBER(KEXCEPTION_FRAME, MxCsr, DWORD),
    MEMBER(KEXCEPTION_FRAME, Rbp, QWORD),
    MEMBER(KEXCEPTION_FRAME, Rbx, QWORD),
    MEMBER(KEXCEPTION_FRAME, Rdi, QWORD),
    MEMBER(KEXCEPTION_FRAME, Rsi, QWORD),
    MEMBER(KEXCEPTION_FRAME, R12, QWORD),
    MEMBER(KEXCEPTION_FRAME, R13, QWORD),
    MEMBER(KEXCEPTION_FRAME, R14, QWORD),
    MEMBER(KEXCEPTION_FRAME, R15, QWORD),
    MEMBER(KEXCEPTION_FRAME, Return, QWORD),
END_STRUCT(KEXCEPTION_FRAME),
SIZE(sizeof_KEXCEPTION_FRAME, KEXCEPTION_FRAME),

HEADER("KNONVOLATILES"),
BEGIN_STRUCT(KNONVOLATILES),
    MEMBER(KNONVOLATILES, Rbp, QWORD),
    MEMBER(KNONVOLATILES, Rbx, QWORD),
    MEMBER(KNONVOLATILES, Rdi, QWORD),
    MEMBER(KNONVOLATILES, Rsi, QWORD),
    MEMBER(KNONVOLATILES, R12, QWORD),
    MEMBER(KNONVOLATILES, R13, QWORD),
    MEMBER(KNONVOLATILES, R14, QWORD),
    MEMBER(KNONVOLATILES, R15, QWORD),
    MEMBER(KNONVOLATILES, Xmm6, OWORD),
    MEMBER(KNONVOLATILES, Xmm7, OWORD),
    MEMBER(KNONVOLATILES, Xmm8, OWORD),
    MEMBER(KNONVOLATILES, Xmm9, OWORD),
    MEMBER(KNONVOLATILES, Xmm10, OWORD),
    MEMBER(KNONVOLATILES, Xmm11, OWORD),
    MEMBER(KNONVOLATILES, Xmm12, OWORD),
    MEMBER(KNONVOLATILES, Xmm13, OWORD),
    MEMBER(KNONVOLATILES, Xmm14, OWORD),
    MEMBER(KNONVOLATILES, Xmm15, OWORD),
END_STRUCT(KNONVOLATILES),
SIZE(sizeof_KNONVOLATILES, KNONVOLATILES),

HEADER("KSTART_FRAME"),
BEGIN_STRUCT(KSTART_FRAME),
    MEMBER(KSTART_FRAME, StartRoutine, QWORD),
    MEMBER(KSTART_FRAME, StartContext, QWORD),
END_STRUCT(KSTART_FRAME),
SIZE(sizeof_KSTART_FRAME, KSTART_FRAME),

