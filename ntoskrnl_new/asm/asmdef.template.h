

HEADER("Pointer size"),
SIZE(SizeofPointer, PVOID),

HEADER("Context Frame Flags"),
CONSTANT(CONTEXT_FULL),
CONSTANT(CONTEXT_CONTROL),
CONSTANT(CONTEXT_INTEGER),
CONSTANT(CONTEXT_SEGMENTS),
CONSTANT(CONTEXT_FLOATING_POINT),
CONSTANT(CONTEXT_DEBUG_REGISTERS),

HEADER("Processor mode"),
CONSTANT(KernelMode),
CONSTANT(UserMode),

HEADER("Status codes"),
CONSTANT(STATUS_ACCESS_VIOLATION),
CONSTANT(STATUS_ASSERTION_FAILURE),
CONSTANT(STATUS_ARRAY_BOUNDS_EXCEEDED),
CONSTANT(STATUS_BAD_COMPRESSION_BUFFER),
CONSTANT(STATUS_BREAKPOINT),
CONSTANT(STATUS_CALLBACK_POP_STACK),
CONSTANT(STATUS_DATATYPE_MISALIGNMENT),
CONSTANT(STATUS_FLOAT_DENORMAL_OPERAND),
CONSTANT(STATUS_FLOAT_DIVIDE_BY_ZERO),
CONSTANT(STATUS_FLOAT_INEXACT_RESULT),
CONSTANT(STATUS_FLOAT_INVALID_OPERATION),
CONSTANT(STATUS_FLOAT_OVERFLOW),
CONSTANT(STATUS_FLOAT_STACK_CHECK),
CONSTANT(STATUS_FLOAT_UNDERFLOW),
CONSTANT(STATUS_FLOAT_MULTIPLE_FAULTS),
CONSTANT(STATUS_FLOAT_MULTIPLE_TRAPS),
CONSTANT(STATUS_GUARD_PAGE_VIOLATION),
CONSTANT(STATUS_ILLEGAL_FLOAT_CONTEXT),
CONSTANT(STATUS_ILLEGAL_INSTRUCTION),
CONSTANT(STATUS_INSTRUCTION_MISALIGNMENT),
CONSTANT(STATUS_INVALID_HANDLE),
CONSTANT(STATUS_INVALID_LOCK_SEQUENCE),
CONSTANT(STATUS_INVALID_OWNER),
CONSTANT(STATUS_INVALID_PARAMETER),
CONSTANT(STATUS_INVALID_PARAMETER_1),
CONSTANT(STATUS_INVALID_SYSTEM_SERVICE),
//CONSTANT(STATUS_INVALID_THREAD),
CONSTANT(STATUS_INTEGER_DIVIDE_BY_ZERO),
CONSTANT(STATUS_INTEGER_OVERFLOW),
CONSTANT(STATUS_IN_PAGE_ERROR),
CONSTANT(STATUS_KERNEL_APC),
CONSTANT(STATUS_LONGJUMP),
CONSTANT(STATUS_NO_CALLBACK_ACTIVE),
CONSTANT(STATUS_NO_EVENT_PAIR),
CONSTANT(STATUS_PRIVILEGED_INSTRUCTION),
CONSTANT(STATUS_SINGLE_STEP),
CONSTANT(STATUS_STACK_BUFFER_OVERRUN),
CONSTANT(STATUS_STACK_OVERFLOW),
CONSTANT(STATUS_SUCCESS),
CONSTANT(STATUS_THREAD_IS_TERMINATING),
CONSTANT(STATUS_TIMEOUT),
CONSTANT(STATUS_UNWIND),
CONSTANT(STATUS_UNWIND_CONSOLIDATE),
CONSTANT(STATUS_USER_APC),
CONSTANT(STATUS_WAKE_SYSTEM_DEBUGGER),

HEADER("Thread states"),
CONSTANT(Initialized),
CONSTANT(Ready),
CONSTANT(Running),
CONSTANT(Standby),
CONSTANT(Terminated),
CONSTANT(Waiting),

HEADER("IRQL"),
CONSTANT(PASSIVE_LEVEL),
CONSTANT(APC_LEVEL),
CONSTANT(DISPATCH_LEVEL),
#ifdef _M_AMD64
CONSTANT(CLOCK_LEVEL),
#else
CONSTANT(CLOCK1_LEVEL),
CONSTANT(CLOCK2_LEVEL),
#endif
CONSTANT(IPI_LEVEL),
CONSTANT(POWER_LEVEL),
CONSTANT(PROFILE_LEVEL),
CONSTANT(HIGH_LEVEL),
RAW("#ifdef NT_UP"),
{TYPE_CONSTANT, "SYNCH_LEVEL", DISPATCH_LEVEL},
RAW("#else"),
{TYPE_CONSTANT, "SYNCH_LEVEL", (IPI_LEVEL - 2)},
RAW("#endif"),

HEADER("Stack sizes"),
CONSTANT(KERNEL_STACK_SIZE),
CONSTANT(KERNEL_LARGE_STACK_SIZE),
CONSTANT(KERNEL_LARGE_STACK_COMMIT),
//CONSTANT(DOUBLE_FAULT_STACK_SIZE),
#ifdef _M_AMD64
CONSTANT(KERNEL_MCA_EXCEPTION_STACK_SIZE),
//CONSTANT(NMI_STACK_SIZE),
#endif

HEADER("Miscellaneous Definitions"),
//CONSTANT(BASE_PRIORITY_THRESHOLD),
//CONSTANT(EVENT_PAIR_INCREMENT),
CONSTANT(RPL_MASK),



/* STRUCTURE OFFSETS *********************************************************/

HEADER("LIST_ENTRY"),
BEGIN_STRUCT(LIST_ENTRY),
    MEMBER(LIST_ENTRY, Flink, POINTER),
    MEMBER(LIST_ENTRY, Blink, POINTER),
END_STRUCT(LIST_ENTRY),

HEADER("KAPC"),
BEGIN_STRUCT(KAPC),
    MEMBER(KAPC, Type, BYTE),
    MEMBER(KAPC, Size, BYTE),
    MEMBER(KAPC, Thread, POINTER),
    MEMBER(KAPC, ApcListEntry, LIST_ENTRY),
    MEMBER(KAPC, KernelRoutine, POINTER),
    MEMBER(KAPC, RundownRoutine, POINTER),
    MEMBER(KAPC, NormalRoutine, POINTER),
    MEMBER(KAPC, NormalContext, POINTER),
    MEMBER(KAPC, SystemArgument1, POINTER),
    MEMBER(KAPC, SystemArgument2, POINTER),
    MEMBER(KAPC, ApcStateIndex, BYTE),
    MEMBER(KAPC, ApcMode, BYTE),
    MEMBER(KAPC, Inserted, BYTE),
END_STRUCT(KAPC),
SIZE(ApcObjectLength, KAPC),

HEADER("EXCEPTION_RECORD"),
BEGIN_STRUCT(EXCEPTION_RECORD),
    MEMBER(EXCEPTION_RECORD, ExceptionCode, DWORD),
    MEMBER(EXCEPTION_RECORD, ExceptionFlags, DWORD),
    MEMBER(EXCEPTION_RECORD, ExceptionRecord,  POINTER),
    MEMBER(EXCEPTION_RECORD, ExceptionAddress, POINTER),
    MEMBER(EXCEPTION_RECORD, NumberParameters, DWORD),
    MEMBER(EXCEPTION_RECORD, ExceptionInformation, QWORD),
END_STRUCT(EXCEPTION_RECORD),
SIZE(sizeof_EXCEPTION_RECORD, EXCEPTION_RECORD),

HEADER("KTHREAD"),
BEGIN_STRUCT(KTHREAD),
    MEMBER(KTHREAD, KernelStack, POINTER),
END_STRUCT(KTHREAD),
SIZE(sizeof_KTHREAD, KTHREAD),

HEADER("LOADER_PARAMETER_BLOCK"),
BEGIN_STRUCT(LOADER_PARAMETER_BLOCK),
    MEMBER(LOADER_PARAMETER_BLOCK, KernelStack, POINTER),
END_STRUCT(LOADER_PARAMETER_BLOCK),
SIZE(sizeof_LOADER_PARAMETER_BLOCK, LOADER_PARAMETER_BLOCK),

#ifdef _M_AMD64
#include "asmdef_amd64.template.h"
#endif

